---
layout: ../layouts/Layout.astro
title: cosmo-corr docs
description: Simple project page template for your research paper, built with Astro and Tailwind CSS
favicon: /favicon.svg
thumbnail: /screenshot.png
---

import { Image } from "astro:assets";

import Layout from "../layouts/Layout.astro";

import Header from "../components/Header.astro";
import TwoColumns from "../components/TwoColumns.astro";
import Video from "../components/Video.astro";
import YouTubeVideo from "../components/YouTubeVideo.astro";
import PDF from "../components/PDF.astro";
import Figure from "../components/Figure.astro";
import LaTeX from "../components/LaTeX.astro";
import SmallCaps from "../components/SmallCaps.astro";
import Splat from "../components/Splat.tsx"

import CodeBlock from "../components/CodeBlock.astro";
export const components = {pre: CodeBlock}

import outside from "../assets/outside.mp4";
import transformer from "../assets/transformer.webp";

<Header
  title={frontmatter.title}
  authors={[
    {
      name: "Edward Berman",
      url: "https://ebrmn.space/",
      institution: "Northeastern University",
    },
    {
      name: "et al.",
      institution: "Institution Two",
    },
  ]}
  conference="In prep."
  notes={[
    {
      symbol: "*",
      text: "author note one",
    },
    {
      symbol: "â€ ",
      text: "author note two",
    },
  ]}
  links={[
    {
      name: "Paper",
      url: "",
      icon: "fa-solid:file-pdf",
    },
    {
      name: "Code",
      url: "https://github.com/EdwardBerman/cosmo-corr",
      icon: "mdi:github",
    },
    {
      name: "arXiv",
      url: "",
      icon: "academicons:arxiv",
    },
  ]}
  />

<Video source={outside} />

## Abstract

Properly estimating correlations between objects at different spatial scales necessitates <LaTeX inline formula="\mathcal{O}(n^2)" /> distance calculations. For this reason, most widely adopted packages for estimating correlations use clustering algorithms to approximate local trends. Methods for quantifying the error introduced by clustering have been understudied. In response, we present an algorithm for estimating correlations that is probabilistic in the way that it clusters objects, enabling us to quantify the uncertainty caused by clustering simply through model inference. We also observe that these soft clustering assignments enable correlation estimators that are theoretically differentiable with respect to their input catalogs. Thus, we follow by building up a theoretical framework for differentiable correlation functions and describe their utility in comparison to existing surrogate models. Notably, we find that the repeated use of the normalization and distance function calls makes gradient calculations slow and sparsity patterns in Jacobians that propagate through the chain rule makes the precision unstable, pointing towards either approximate or surrogate methods as a necessary solution to exact gradients from correlation functions. To that end, we close with a discussion of surrogate models as proxies for correlation functions. We provide an example that demonstrates the efficacy of surrogate models to enable gradient based optimization of astrophysical model parameters, successfully minimizing a correlation function output. Our numerical experiments cover science cases across cosmology, from point spread function (PSF) modeling efforts to gravitational simulations to intrinsic alignments (IA). We release the code used in this study at [https://github.com/EdwardBerman/cosmo-corr](https://github.com/EdwardBerman/cosmo-corr) and [https://github.com/EdwardBerman/jax-cosmo-corr](https://github.com/EdwardBerman/jax-cosmo-corr).

## Another section, with a figure

Use the figure component to display images, videos, equations, or any other element, with an optional caption.

<Figure
    caption="Diagram of the transformer deep learning architecture."
  >
    <Image src={transformer} alt="alt text" />
</Figure>

## Two columns

Use the two columns component to display two columns of content. In this example, the first column contains a figure with a YouTube video and the second column contains a figure with a custom [React](https://react.dev/) component. By default, they display side by side, but if the screen is narrow enough (for example, on mobile), they're arranged vertically.

<TwoColumns>
  <Figure slot="left" caption="Take a look at this YouTube video.">
    <YouTubeVideo videoId="wjZofJX0v4M" />
  </Figure>
  <Figure slot="right" caption="Now look at this Gaussian Splat, rendered with a React component.">
    <Splat client:idle />
  </Figure>
</TwoColumns>

## LaTeX

You can also add LaTeX formulas, rendered during the build process using [KaTeX](https://katex.org/) so they're quick to load for visitors of your project page. You can write them inline, like this: <LaTeX inline formula="a^2 + b^2 = c^2" />. Or, you can write them as a block:

<LaTeX formula="\int_a^b f(x) dx" />

## BibTeX citation

```
@misc{roman2024academic,
  author = "{Roman Hauksson}",
  title = "Academic Project Page Template",
  year = "2024",
  howpublished = "\url{https://research-template.roman.technology}",
}
```
